# README for file:
yumupdate.sh

# What does it do?  
On CentOS 6 and 7, you can run this script and it will 1) "yum -y update" and 2) reboot OS, only when kernel is updated. This script will create folder  /root/logsyum to store log files generated by this script.
Here is a summary of what the script does.
- Runs "yum -y update".
- As yum update runs, activity is logged to following file: /root/logsyum/yum-update-yyyymmdd-hhmmss-timezone.log.
- After "yum -y update" is done, the script checks /root/logsyum/yum-update-yyyymmdd-hhmmss-timezone.log to see if kernel was updated.
- If (and only if) kernel was updated, yumupdate.sh starts reboot of the OS.

# What is it?    
This bash shell script is for automating 1) running yum update and 2) rebooting OS when yum update requires it. You can schedule this to run regularly with cron on CentOS 6/7 servers and you will never need to worry about having to run yum update manually. 

# Technologies used 
Bash shell script

# Goal of the project      
This was created for personal use. It is used on my CentOS servers that I manage.

# Stage of the project    
Complete

# Known issues or things that are not properly done
- Depending on your server's software and config, beware that blindly yum updating and rebooting can cause data corruption/loss. Make sure you have adequate backup and documentation on how the server was set up, just in case yum update + reboot causes problems.
- Certain software such as database under heavy load might need time to properly shut down service. This yumupdate.sh script might need to be modified so that it waits/detects proper shutdown of critical services before rebooting OS. 
- You should test this script in your environment if you plan to use it on production systems with critical data.

# Specific things to look for    
The script will reboot OS only when necessary. 


# How to run it on CentOS 6/7
## Pull file from Github, set permission, and run it, all as root in this example
```
mkdir /root/bin/    # or use a folder of your choice

cd /root/bin

wget https://raw.githubusercontent.com/paulcodrpub/tool-script/master/yumupdate.sh

chmod 700 yumupdate.sh

/root/bin/yumupdate.sh
```
The server will reboot, but only if kernel was updated.

## Cron
As root, edit /etc/crontab and insert following line. Save the change.
```
15 23 * * 0,3 root /root/bin/yumupdate.sh
```
Now the server will run yumupdate.sh every Sun and Wed, at 23:15 (aka 11:15pm). Whenever kernel is updated, the server will also reboot.


# Live Demo
None